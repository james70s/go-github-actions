# 标记t*标签，作为内部测试用
name: Stage
on:
  push:
    branches:
      - dev
    # tags:
    #   - t*

jobs:
  # release:
  #   name: Release on GitHub
  #   runs-on: ubuntu-latest
  #   steps:
  #   - name: Checkout
  #     uses: actions/checkout@v1

  #   # - name: Info
  #   #   run: echo docker.pkg.github.com/${{ github.repository }}:${IMAGE_TAG}

  #   - name: Build docker & push
  #     uses: mr-smithers-excellent/docker-build-push@v2
  #     with:
  #       image: ${{ github.repository }}
  #       # tag: latest
  #       registry: registry.limei.net.cn
  #       dockerfile: Dockerfile
  #       username: ${{ secrets.REGISTRY_USERNAME }}
  #       password: ${{ secrets.REGISTRY_PASSWORD }}
  
  
  deploy:
    name: Deploy to Host
    runs-on: ubuntu-latest
    # needs: [docker]
    steps:
    - name: Login to host and deploy
      uses: appleboy/ssh-action@master
      with:
        host: ${{ secrets.SUN_HOST }}
        key: ${{ secrets.SUN_DEPLOY_KEY }}
        username: ${{ secrets.SUN_HOST_USERNAME }}
        # password: ${{ secrets.SUN_HOST_PASSWORD }}
        port: ${{ secrets.SUN_HOST_PORT }}
        # script: whoami
        script: |
          cd sun
          git pull
          ls -al